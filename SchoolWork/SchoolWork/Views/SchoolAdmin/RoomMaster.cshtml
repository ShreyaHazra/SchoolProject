@model SchoolWork.Models.Routine

@{
    ViewBag.Title = "Assign Subject";
}

@{ 

    String bgcolor = "";
}
    <html lang="en">
    <head>
        <meta charset="utf-8">

        

        <link href="~/CSS/stylesheet2.css" rel="stylesheet" />
        <style>
            .text-danger {
                font-weight: 700;
                color: red;
            }

            .body-div {
                margin-top: 140px;
                border-color: indigo;
                border-style: groove;
                padding: 35px;
            }

            .Education {
                border-color: lightyellow;
                border-style: inset;
                padding: 17px;
            }

            p {
                text-align: center;
            }


            .container {
                width: 70% !important;
                padding: 10px !important;
            }

            .well {
                background-color: #ead4b3 !important;
                border-style: inset;
            }

            .left {
                float: left;
                margin-right: 10px;
                width: 48%;
            }

            .right {
                float: left;
                margin-left: 10px;
                width: 48%;
            }
            .hr{
                margin-top:14px !important;
                margin-bottom:14px !important;
            }
        </style>

    </head>
    <body id="LoginForm" style="background-color:cornflowerblue;">
        <div class="container">
            <div class="body-div" style="background-color:blanchedalmond; max-width:100%">
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        @*<a class="btn btn-primary btn-product" onclick="@("window.location.href='" + @Url.Action("SchoolNoticeAdd", "SchoolAdmin") + "'");"><span class="glyphicon glyphicon-pencil"></span>Add Notice</a>*@
                        <a class="btn btn-primary" onclick="@("window.location.href='" + @Url.Action("AdminHeaderBoard", "DashBoard") + "'");"><span class="glyphicon glyphicon-home"></span> &nbsp; Home</a>

                        <a class="btn btn-danger" onclick="history.go(-1)"><span class="glyphicon glyphicon-arrow-left"></span> &nbsp; Return</a>

                        @*<input type="button"  value="Return" class="btn btn-danger" />*@
                    </div>
                    <div class="col-sm-12 col-md-12 text-center">
                        <h1 style="color:blueviolet;"><b>Assign Room Category</b></h1>

                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="row Education" id="extTab1">
                    <div class="col-sm-12">
                        <ul class="nav nav-pills">
                            <li class="active col-md-6 text-center left">
                                <a href="#1a" data-toggle="tab">Add Room Category</a>
                            </li>
                            <li class="col-md-6 text-center right">
                                <a href="#2a" data-toggle="tab">View Room Category</a>
                            </li>
                        </ul>
                        <br />
                        <div class="tab-content clearfix">
                            <!--Adding Form-->
                            <div class="tab-pane active well" id="1a">

                                @using (Html.BeginForm("RoomMaster", "SchoolAdmin", FormMethod.Post, new { enctype = "multipart/form-data", @id = "Roomform" }))
                                {
                                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                    <div class="row">
                                        <div class="col-sm-12 col-md-12">
                                            <div class="class-sm-2 col-md-2 col-md-offset-2">
                                                <label>
                                                    @*<i class="glyphicon glyphicon-list"></i>*@ <font color="brown"> Room Name:</font>
                                                </label>
                                            </div>
                                            <div class="col-sm-4 col-md-4">
                                                @Html.TextBoxFor(m => m.RoomName, new { @class = "form-control", @onChange = "Javascript:CheckRoomName()", @id = "RoomName" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>

                                    <div class="row">
                                        <div class="col-sm-12 col-md-12">
                                            <div class="class-sm-2 col-md-2 col-md-offset-2">
                                                <label>
                                                    @*<i class="glyphicon glyphicon-list"></i>*@ <font color="brown"> Room Number:</font>
                                                </label>
                                            </div>
                                            <div class="col-sm-4 col-md-4">
                                                @Html.TextBoxFor(m => m.RoomNo, new { @class = "form-control", @onChange = "Javascript:CheckRoomNumber()", @id = "RoomNo" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>


                                    <div class="row">
                                        <div class="col-sm-12 col-md-12">
                                            <div class="class-sm-2 col-md-2 col-md-offset-2">
                                                <label>
                                                    @*<i class="glyphicon glyphicon-list"></i>*@ <font color="brown"> Floor:</font>
                                                </label>
                                            </div>
                                            <div class="col-sm-4 col-md-4">
                                                @if (Model.id != 0)
                                                {
                                                    @Html.TextBoxFor(m => m.Floor, new { @class = "form-control", @id = "Floor" })
                                                }
                                                @if (Model.id == 0)
                                                {

                                                    <input type="text" name="Floor" id="Floor" class="form-control">
                                                }

                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>


                                    <div class="row">
                                        <div class="col-sm-12 col-md-12">
                                            <div class="class-sm-2 col-md-2 col-md-offset-2">
                                                <font color="brown"> Room Category:</font>
                                            </div>
                                            <div class="col-sm-4 col-md-4">
                                                @*Model.Emp_Name, "Please Select An Employee", new { @class = "form-control", @onchange = "getAllChange()" })*@
                                                @Html.DropDownListFor(m => m.Room, Model.RoomCategory, "Please Select Room Category", new { @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div><br />


                                    <div class="row">
                                        <div class="col-sm-12 col-md-12">
                                            <div class="class-sm-2 col-md-2 col-md-offset-2">
                                                <font color="brown"> Occupied/Empty:</font>
                                            </div>
                                            <div class="col-sm-4 col-md-4">

                                                <select id="Occupied" name="Occupied" class="form-control">
                                                    <option value="">--Status--</option>
                                                    @if (Model.id != 0)
                                                    {
                                                        if (Model.Occupied == "occupied")
                                                        {
                                                            <option value="occupied" selected>Occupied</option>
                                                            <option value="Empty">Empty</option>
                                                        }
                                                        if (Model.Occupied == "Empty")
                                                        {
                                                            <option value="occupied">Occupied</option>
                                                            <option value="Empty" selected>Empty</option>
                                                        }
                                                    }
                                                    @if (Model.id == 0)
                                                    {
                                                        <option value="occupied">Occupied</option>
                                                        <option value="Empty">Empty</option>

                                                    }

                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div><br />

                                    <div class="row">
                                        <div class="col-sm-12 col-md-10 col-md-offset-3">
                                            <input type="submit" value="Submit" class="btn btn-success" />
                                            &nbsp;&nbsp;
                                            <input type="reset" value="Reset" class="btn btn-warning">
                                            &nbsp;&nbsp;
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>

                                }

                            </div>
                            <!--End Adding Form--->
                            <div class="tab-pane well" id="2a">
                                <table class="table" id="products">
                                    <thead>
                                        <tr>
                                            <th>@Html.DisplayName("Room#")</th>
                                            <th>@Html.DisplayName("Room Name")</th>
                                            <th>@Html.DisplayName("Room Category")</th>
                                            <th>@Html.DisplayName("Occupied")</th>
                                            <th>@Html.DisplayName("Action")</th>



                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (Model.Templist.Count != 0)
                                        {
                                            foreach (var item in Model.Templist)
                                            {
                                                <tr>
                                                    <td>@Html.DisplayFor(modelItem => item.RoomNo)</td>
                                                    <td>@Html.DisplayFor(modelItem => item.RoomName)</td>
                                                    <td>@Html.DisplayFor(modelItem => item.Room)</td>
                                                    <td>@Html.DisplayFor(modelItem => item.Occupied)</td>

                                                    <td>
                                                        <a href="./@item.id">
                                                            Edit
                                                        </a> | <a href="Javascript:Rem(@item.id)" class="btnDelete">Delete</a>

                                                    </td>
                                                </tr>
                                            }
                                        }
                                        @if (Model.Templist.Count == 0)
                                        {

                                            <tr>
                                                <td colspan="5">
                                                    <p style="text-align:center">
                                                        <h2><font color="cornflowerblue"> No Data Found</font></h2>
                                                    </p>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                            <!---End View Table-->
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div><br />
                <!-- GRAPH ROW START-->
                <div class="row Education pre-scrollable" style="height:250px;" id="graphDiv">
                    <div class="col-sm-12 text-center">
                        <h3><b><u>Room Allocation View</u></b></h3>
                    </div>
                    <div class="clearfix"></div><br />
                    <div class="bottom col-sm-12 col-md-12">
                        @foreach (var item in Model.Templist)
                        {

                            if (@item.Occupied == "occupied")
                            {
                                bgcolor = "#e63d3dab";

                            }
                            if (@item.Occupied == "Empty")
                            {
                                bgcolor = "lightgreen";

                            }
                            <div class="col-md-3 col-sm-6">
                                <div style="padding:5px;width: 18rem; border:1px solid;background: @bgcolor;
                                            box-shadow: 5px 5px 5px rgba(70, 70, 70, 0.6);">
                                    <div class="card isColorCheck">
                                        <div class="card-header text-center">
                                            <p style="font-size:14px;font-weight:bold;">Room Name: &nbsp;@item.RoomName</p>
                                        </div>
                                        <hr />
                                        <div class="card-body">
                                            <p>@item.RoomNo &nbsp;@item.Room</p>
                                            <p></p>
                                            <p>Status: &nbsp;@item.Occupied</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <!-- GRAPH ROW END-->
            </div>
        </div>



        @section Scripts
    {

            @Scripts.Render("~/bundles/jqueryval")


            @Styles.Render("~/Content/cssjqryUi")



            <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
            <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
            <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
            <link href="~/CSS/StyleSheet5.css" rel="stylesheet" />
            <link href="~/CSS/Table.css" rel="stylesheet" />

            <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>



            <!--sweet alert-->
            <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>


            <!-- DataTables CSS -->

            <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.5/css/jquery.dataTables.css">


            <!-- DataTables -->
            <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.5/js/jquery.dataTables.js">
            </script>
            <script>
                $(document).ready(function () {
                    $('#products').DataTable();

                    $("#products").on('click','.btnDelete',function(){
                        $(this).closest('tr').remove();
                     });


                });
            </script>


            


            <script type="text/javascript">


                function Rem(id) {

                    $.ajax({
                        type: "POST",
                        url: "/SchoolAdmin/AjaxDeleteRoom",
                        data: '{RoomId:' + id + '}',
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {
                            swal({
                                title: "",
                                text: response,
                                icon: "success",
                                timer: 700000
                            });

                            // window.location.reload();

                        },
                        failure: function (response) {
                            alert("from  inner failure" + response.responseText);
                        },
                        error: function (response) {
                            alert("from inner error  " + response.responseText);
                        }
                    });

                    location.reload();
                    //$("#divId").load(location.href + " #divId>*", "");
                   // $("#graphDiv").load(location.href + " #graphDiv>*", "");
                }
                function CheckRoomName() {
                    var rmnm = $("#RoomName").val();
                    $.ajax({
                        type: "POST",
                        url: "/SchoolAdmin/AjaxCheckRoomName",
                        data: '{RoomName:"' + rmnm + '"}',
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {


                            if (response.length != 0) {
                                swal({
                                    title: "",
                                    text: response,
                                    icon: "error",
                                });

                                $("#RoomName").val("");
                                $("#RoomName").focus(true);
                            }
                            else;


                        },
                        failure: function (response) {
                            alert("from  inner failure" + response.responseText);
                        },
                        error: function (response) {
                            alert("from inner error  " + response.responseText);
                        }
                    });

                }
                function CheckRoomNumber() {




                    var rval = $("#RoomNo").val();

                    //alert(rval);
                    $.ajax({
                        type: "POST",
                        url: "/SchoolAdmin/AjaxCheckRoomNumber",
                        data: '{RoomNumber:' + rval + '}',
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {


                            if (response.length != 0) {
                                swal({
                                    title: "",
                                    text: response,
                                    icon: "error",
                                });

                                $("#RoomNo").val("");


                                $("#RoomNo").focus();


                            }
                            else;


                        },
                        failure: function (response) {
                            alert("from  failure" + response.responseText);
                        },
                        error: function (response) {
                            alert("from  error  " + response.responseText);
                        }
                    });



                }

                //function formReset() {

                //    alert("Reset");

                //    document.getElementById("RoomNo").value = "";

                //    alert(document.getElementById("RoomNo").value);
                //    $("#RoomName").val("");
                //     $("#Floor").val("");
                //    //$("#RoomNo").val("");
                //     //$("#RoomNo").val("");

                //    //document.getElementById("Roomform").reset();

                //    // $('#configform')[0].reset();
                //}




                $('.btn:reset').click(function (ev) {
                    ev.preventDefault();
                    $(this).closest('form').find("input").each(function (i, v) {
                        $(this).val("");
                    });
                });
            </script>

        }
    </body>
    
    </html>
